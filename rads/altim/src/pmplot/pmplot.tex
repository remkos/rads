\documentclass[titlepage,a4paper]{article}
\usepackage{som,verbatim,palatino}
\usepackage{graphicx}
\title{Subroutine Library PMPLOT \\ ~ \\
A Geographical Extension to PGPLOT \\ ~ \\
User's Guide and Reference}
\author{Remko Scharroo}
\date{Version \input{pmplot.ver} -- \today}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\Input#1{\vbox{\input{#1}}}
\def\SECTION#1{\subsection{#1}}
\def\SUBSECTION#1{\subsubsection{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\sloppy
\oddsidemargin 0cm
\evensidemargin 0cm
\topmargin -1cm
\headheight 0cm
\textheight 25cm
\textwidth  16.5cm
\begin{document}
\maketitle
\pagenumbering{arabic}
\tableofcontents
\clearpage

\section{Introduction}
PMPLOT is the Geographical Extension to the PGPLOT subroutine library. 
It is intended to be used by those that want to include maps in their
plots. However, many extra more-or-less plain PGPLOT subroutines have
been added or changed. Also additional Hershy fonts are added to the
font file that are only excessable through PMPLOT.

The PMPLOT library has been ported to various systems. Presently it is
only available on the IBM Risk 6000 workstations of the Section Space
Research and Technology. The library can be linked to any of your
FORTRAN programs by specifying a linkage \verb|-lpmplot|, \eg
\begin{verbatim}
xlf example.f -o example -lpmplot
\end{verbatim}

The PMPLOT library is courtesy of Remko Scharroo, Delft University of
Technology, Section Space Research \&\ Technology
(E-mail: \verb|Remko.Scharroo@lr.tudelft.nl|)

\subsection{History}
Since creation the following changes have been made to the software:
\begin{leftitemize}
\item Version 9101
\begin{leftitemize}
\item Another 7 projections were added to PGGPLOT;
\item PGGENV, PGGXINV, and PGGYINV were removed from the library;
\item PGGX and PGGY are devised to also support non-linear projections;
\item PGGCINV was added as a new routine taking care of the inverse coordinate
  conversion;
\item RNGCIR was created to compute range circles;
  GRTCIR computes great circles;
\item PGGWDB has been changed (also the input) to improve flexibility.
\item The syntax of PGGBOX and PGGDEF have been changed slightly in order to
  support azimuthal and conical projections.
\end{leftitemize}
\item Version 9102
\begin{leftitemize}
\item PGGCVEC is a new routine that converts the position coordinates and
  azimuth of a vector to map coordinates and angle.
\item PGMARK is created to facilitate the drawing of several markers in
  different sizes and at different tilts in one call.
\item Markers 0858 and 0859 are added to the font library.
\end{leftitemize}
\item Version 9103
\begin{leftitemize}
\item Markers 0791 through 0795 are added to the font library.
\item Mountains and bathymetry has been added to the World Data Bank.
\item The definition of PGGWDB has been changed slightly in order to support
  the mountain and bathymetry files. This change is important for those
  who want to plot all ranks.
\end{leftitemize}
\item Version 9104
\begin{leftitemize}
\item PGGPLOT has been removed from dutlru4. However it works properly on both
  dutlru2 and dutlru4.
\item NEW: PGGPLOT is now also available on the Convex.
\item All WDB files have been compressed.
  Again the PGGWDB call has been altered.
  Read the manual carefully.
\end{leftitemize}
\item Version 9105
\begin{leftitemize}
\item Again 3 projection have been added to the PGGPLOT library:
  Mollweide projection, Gall's stereographic projection, and Bartholomew's
  `The Times' projection.
\end{leftitemize}
\item Version 9200
\begin{leftitemize}
\item PGGPLOT is renamed to PMPLOT. Thus all routines starting with PGG, start
  now with PM.
\end{leftitemize}
\item Version 9201
\begin{leftitemize}
\item Land fill in PMWDB included. See description.
\item Extra PG-routine PGVP.
\item Extra fonts added to the font library to plot oceanic platform and SLR
  systems. This meant extending the size of the library.
\end{leftitemize}
\item Version 9300
\begin{leftitemize}
\item Extra projection: tilted rectangular (type 34).
\item Plot in Color PostScript mode included. Devices /CPS and
  /CVPS. This has effect for all plotting routines, like PGSCI and PGPIXL.
\end{leftitemize}
\item Version 9304.x
\begin{leftitemize}
\item PostScript device standardised to one source. \verb|BoundingBox| is
  determined and rewritten at the top of the PostScript file. Also
  generating command is included in the file.
\item PMQINF routine is introduced.
\item First manual typeset in \LaTeX.
\item (9304.1) Allow 255 grey shades and setting of grey shade with PGSCR.
\item (9304.2) Include new options in PMBOX to give nice degree-minutes
  notation. PGNUMB has changed as well.
\end{leftitemize}
\item Version 9306.x
\begin{leftitemize}
\item Small unnoticeable changes.
\item FASTIO incorporated in PMWDB. Much faster.
\end{leftitemize}
\item Version 9308
\begin{leftitemize}
\item Fill area and pixel dump routines improved.
\item PPM and VPPM device types introduced.
\end{leftitemize}
\item Version 9310.x
\begin{leftitemize}
\item Plate boundary data set and supporting change to PMWDB implemented.
\item Clipping of symbols or lines switchable.
\end{leftitemize}
\item Version 9404
\begin{leftitemize}
\item Small changes to PSDRIV to improve transparent use of PGSCR
\end{leftitemize}
\item Version 9601
\begin{leftitemize}
\item Bug removed from PMBOX (wrong major ticks in projections not equal to
1)
\item Alignment with PGPLOT 5.0. PGMARK renamed to PGPTX, PGVP to PGSVPX.
\end{leftitemize}
\item Version 9607
\begin{leftitemize}
\item Aligned with PGPLOT 5.1.
\item PMWINDOW renamed to PMSWIN. PMPOLY renamed to PMCPOL, and most of
its functionality transferred to PMCONV.
\end{leftitemize}
\end{leftitemize}

\subsection{Projections}
\label{projections}
PMPLOT routines take care of scaling and transformation of geographical
data under certain projections. The present version (9300) supports fifteen
types of projections.
\begin{itemize}
\item Cylindrical projections:
   \begin{description}
   \item[~1.] Equi-Rectangular;
   \item[~2.] Peters;
   \item[~3.] Mercator;
   \item[~4.] Miller;
   \item[~5.] Gall's stereographic projection.
   \end{description}
\item Azimuthal projections:
   \begin{description}
   \item[11.] Orthographic;
   \item[12.] Perspective;
   \item[13.] Azimuthal Equal-Area;
   \item[14.] Azimuthal Equi-Distant.
   \end{description}
\item Conic projections:
   \begin{description}
   \item[21.] Ptolemy Conic Equal-Interval;
   \item[22.] Kavraiskiy IV Conic Equal-Interval.
   \end{description}
\item Miscellaneous projections:
   \begin{description}
   \item[31.] Sinusoidal or Mercator Equal-Area;
   \item[32.] Mollweide projection;
   \item[33.] Bartholomew's `The Times' projection;
   \item[34.] Tilted rectangular projection.
   \end{description}
\item Polar projections:
   \begin{description}
   \item[41.] Polar projection centred on North Pole;
   \item[42.] Polar projection centred on South Pole;
   \end{description}
\end{itemize}

\subsubsection*{Equi-rectangular projection (1)}
The Equi-Rectangular Projection, often referred to as the plane chart,
is the only projection that is linear in both directions, i.e. tick marks
along the x-axis are spaced equally, as well as along the y-axis. The ratio
of the spacing between meridians on the one hand and parallels on the other
depends on the latitude of the true-scale parallel. If the scale must be
`true' at the equator, the ratio is 1 to 1 (even if the equator is not in the
map). This projection is most used for large-scale maps such as city plans.
Hand plotting over this type of map is very easy.

\subsubsection*{Peters projection (2)} 
This non-linear projection does not preserve distances, nor shapes, but
preserves areas. Thus areas in the map are at scale; one square millimeter
in the map is the same number of square kilometers in reality anywhere in
the map. Areas further form the true-scale latitude become strongly distorted.

\subsubsection*{Mercator projection (3)}
The spacing of parallels on the Mercator Projection increases progressively
poleward from the equator in a way that makes the projection conformal, i.e.
by increasing the North-South scale to exactly the East-West scale at every
latitude. However, the scale is not the same at each latitude. The conformality
means that any straight line on the Mercator Projection describes a constant
compass course, which makes the projection very useful for navigation purposes.
The user should be aware that distances and areas are seriously exaggerated at
high latitudes.  In fact, the parallels are mapped so far apart at the extreme
latitudes that the map should then be infinitely large. We speak of a
singularity at the poles. Therefore, maps of this type are restricted to 89
degrees North and 89 degrees South.

\subsubsection*{Miller projection (4)}
This is in fact an imperfect Mercator projection. It is neither conformal
nor equal-area and is limited to small-scale maps. Fortunately the
Miller projection is not singular at the poles and looks very much like
the Mercator projection at lower latitudes.

\subsubsection*{Gall's stereographic projection (5)}
This projection is a stereographic projection from an antipodal point on the
equator, on to a cylinder which cuts the Earth at 45 degrees North and 45
degrees South. It's easy to construct and has been widely used for world maps
including those showing distribution data. The projection is neither conformal
nor equal-area. Its principal merit is that it reduces greatly the
distortion at higher latitudes as in the Mercator projection.

\subsubsection*{Orthographic projection (11)}
The Orthographic Projection presents the globe as viewed from infinity,
centered at any point on the globe. This is in fact a special case of the
Perspective Projection, where the observer is infinitely far. The scale of
the Orthographic Projection (as all other azimuthal projections) is true at
the center of the `map'. This projection is very useful for presentations of
entire hemispheres.

\subsubsection*{Perspective projection (12)}
Unlike the Orthographic with the observer at `infinity', the Perspective
focus is from a point in near rather than deep space. One gets the spherical
illusion of viewing from a high satellite. Its primary use is for orientation
with the map centered at on the area of interest. In addition this gives the
opportunity to plot areas less than a hemisphere in Perspective.

\subsubsection*{Azimuthal equal-area projection (13)}
This projection, invented by Lambert, is best suited to small-scale maps
of continental areas or hemispheres. The equivalent property is especially
valuable for depicting distributions or measuring defined areas. The azimuths
from the center point are correct and all straight lines from the center are
great circles.

\subsubsection*{Azimuthal equi-distant projection (14)}
The Azimuthal Equal-Distant projection is employed when the distance and azimuth
are required from a central point to any other point. A popular application
is plotting a hemisphere or even the entire earth around one radio station.

\subsubsection*{Ptolemy projection (21)}
This conic equal-interval projection was invented by Claudius Ptolemy in
the 2nd century B.C.. It has a single standard parallel and equally spaced
parallels and possesses the virtues of being easy to manually construct or
plot on.

\subsubsection*{Kavraiskiy IV projection (22)}
The Kavraiskiy IV Projection with two standard parallels is the result of
Russian efforts to develop a projection "with the least mean square linear
distortion" for the area of the Soviet Union. Because it displays areas of
large longitudinal extent so well, it is the choice for most maps of the
Soviet Union. The scale of the map is true at both standard parallels. Between
the standard parallels distances are slightly underestimated. Outside the
standard parallels distances are slightly exaggerated.

\subsubsection*{Sinusoidal projection (31)}
The Sinusoidal or Mercator Equal-Area Projection was created to reduce the
distortions of shape present in the cylindrical Mercator Projection. It is
an excellent choice for maps with significant North-South dimensions, such
as hemispheres and continents. The equally spaced parallels and true meridional
divisions are also convenient for manual plotting of data. This projection has
not one standard parallels. Any parallel has a true scale.

\subsubsection*{Mollweide projection projection (32)}
In this equal-area projection the central meridian is a straight line at right
angles to the equator and all other parallels, all of which are straight lines
subdivided equally. The spacing of the parallels are derived mathematically
from the fact that the meridians 90 East and West of the central meridian form
a circle equal in area to a hemisphere.
       
\subsubsection*{Bartholomew's `The Times' projection (33)}
This projection was designed to reduce the distortions in area and shape which
are inherent in cylindrical projections, whilst, at the same time, achieving
an approximately rectangular shape overall. It falls in the category of
pseudo-cylindrical. Parallels are projected stereographically as in Gall's
projection. The meridians are less curved than the sine curves of the
Sinusiodal projection. Scale in preserved at 45 degrees North and South
(always).

\subsubsection*{Tilted rectangular projection (34)}
This is a rather odd projection that allows you to plot a map in 3D, like
it is viewed from the southern boundary of the map. As parameters one can
define the vertical scaling and a horizontal tilt of the map. It can be
used to show vertical displacements.

\subsection{World Data Bank}
\label{WDB}
The World Data Bank is a digital representation of the World's coastlines,
islands, lakes, boundaries, and rivers. To plot these items the subroutine
PMWDB was designed. The World Data Bank (WDB) comes in
three levels of detail:
\begin{itemize}
\item WDB~0 represents the coastlines and major islands and lakes
    in 446 lines of a total of 8512 points. Because of the lack of detail
    WDB 0 is only useful for small scale maps (of hemispheres or the entire
    earth). The resolution is 1 arc-minute (about 2 km).
    In addition to this a data set \verb|0.plt| containing plate boundaries is introduced.
\item WDB~1 is divided into of two data sets. One consists of
    87457 points along 974 line segments representing the coastlines, islands
    and lakes of the world in much more detail than WDB~0. It is thus
    especially appropriate for larger scale maps of continents. The second
    data set incorporates the international boundaries of the world (300 line
    segments of 32258 points in total). The resolution of both data sets is
    6 arc-seconds (about 200 m).
\item Since Version 9200 the WDB~1 data set also has a version to plot
    landmasses to be plotted as filled polygons.
    The data set is called \verb|1.lnd|.
    Like any other WDB data set it can be plotted with the
    PMWDB subroutine.
\item WDB~2 was digitised at scales of approximately 1:3000000,
    and should therefore preferably be used at these large scales. The WDB 2
    is divided into 5 groups of 3 or 4 data sets. Each group is associated
    with one geographic area: 1) AFR: Africa and the Middle East; 2) ASI:
    Asia incl. Russia, Australia, New Zealand and Oceania; 3) EUR: Europe;
    4) NAM: North America and Greenland; 5) SAM: South America, Middle America
    and Antarctica. The 3 or 4 files in each group refer to each a different
    type of data: a) BDY: international boundaries; b) CIL: coastlines, islands
    and lakes; c) RIV: rivers; d) PBY: US state borders and Canadian province
    boundaries (only for NAM). All these standard WDB data sets have a
    resolution of 15 m.
\item An extension to WDB contains altitude contours for both
    land and ocean bottom and was converted from the ETOPO5 topography data set.
    The altitude contours on land (MNT) are separated by
    500 meter, starting at 500 meter altitude. This part of the WDB is also
    separated into 5 data sets, one for each geographical region as specified
    above.
    
    The depth contours for the sea bottom (or bathymetry, BTH) start at
    sea level (0 meter) and run up to -10000 meter, each contour separated by
    500 meter. Again there are 5 data sets: 1) IND: Indian Ocean; 2) NAT: North
    Atlantic; 3) NPA: North Pacific; 4) SAT: South Atlantic; 5) SPA: South
    Pacific. The resolution of the contours is 500 meters in altitude (as
    said before) and 10 arc seconds (about 300 m) in horizontal direction,
    based on a grid with a 10-arc-minute resolution.
\end{itemize}
Because of their superiority in detail, the WDB~2 data sets are considerably
larger than each individual WDB~0 or 1 file.

All lines in each file are attached a rank number. These ranks are
hierarchically structured, and are useful for output plotting symbol or
line style definition. Depending on the type of data the rank numbers have
a different meaning, as described in Table~\ref{tab:ranks}.
\clearpage
\input{ranks}

To plot lines use PMWDB. The range of ranks can be specified in your call to
PMWDB along with the name of the data set. It is not required to give
the directory name of the WDB data sets, provided that they are stored in
the directory specified by the \verb|WDB_DIR| environment variable.
The names of these files are:

\begin{verbatim}
0               0.plt           0.lnd

1.bdy           1.cil           1.lnd

2.afr.bdy       2.asi.bdy       2.eur.bdy       2.nam.bdy       2.sam.bdy
2.afr.cil       2.asi.cil       2.eur.cil       2.nam.cil       2.sam.cil
2.afr.riv       2.asi.riv       2.eur.riv       2.nam.riv       2.sam.riv
2.afr.mnt       2.asi.mnt       2.eur.mnt       2.nam.mnt       2.sam.mnt
                                                2.nam.pby

2.ind.bth       2.nat.bth       2.npa.bth       2.sat.bth       2.spa.bth
\end{verbatim}

Although it would be of no interest to most users, we give here a short summary
of the WDB format.
Each data set mentioned above consists actually of two files: one table (with
extension \verb|.TAB|) and one data file (with extension \verb|.DAT|). The table (a direct
access binary file) has one entry for each individual line segment and contains
information about the rank of the segment and the minimum and maximum longitude
and latitude of the points in that segment. Also one field points to the record
of the first of a number of points in that segment, points that are stored in
the data file (a direct access binary file). The formats are given in Tables
\ref{tab:table format} through~\ref{tab:data format 2}.
\input{formats}

The longitudes as stored in the WDB are confined to the range --180 (180W) to
+180 (180E), whereas the latitudes do not exceed, of cause, --90 (90S) or
+90 (90N). Nevertheless the PMWDB routine can manage longitudes in any
other range (even spanning the world more than once).

If you use the land-fill data sets (\verb|0.lnd| or \verb|1.lnd|) the
land masses and lakes will be filled in two different colors (or shades).
In stead of rank numbers you will have to give the color indices for
plotting the land and lakes.

\section{How to use PMPLOT}
PMPLOT is an extension to the PGPLOT subroutine library. Like PGPLOT,
PMPLOT consists mainly of FORTRAN-coded subroutines. Originally, PMPLOT was
designed primarily to include maps in plots generated with the PGPLOT library.
Presently, PMPLOT serves more purposes: it introduced Color PostScript to
the plotting devices, extended the font set, and included new general-purpose
routines or modified some of the standard PGPLOT routines.

The following Sections describe the usage of PMPLOT routines in conjunction
with the standard PGPLOT routines.

\subsection{Example program}
The following program is an example FORTRAN program that uses some of the
PMPLOT routines. We will discuss some of the calls made in this program.
To emphasise the PMPLOT routines, they are capitalised in the source code.
\verbatiminput{example.f}
\medskip
This program can be compiled by executing the command
\begin{verbatim}
xlf example.f -o example -lpmplot
\end{verbatim}
And the output should look like displayed in Figure~\ref{fig:example}.

\begin{figure*}
\includegraphics[angle=90,width=\textwidth]{example.pdf}
\caption{Output of {\tt example.f}.}
\label{fig:example}
\end{figure*}

\subsection{Program structure}
Before using any of the other PMPLOT routine, PMDEF must be called to define
the projection type and scale. This call can be followed by calls to other
PMPLOT procedures to define the size and shape of viewport and the map
boundaries. Furthermore all usual PGPLOT routines can be used as defined in
the PGPLOT manual. One has to keep in mind, however, that the map (x,y)
coordinates do not have to be the same as the true (longitude,latitude)
coordinates. To plot lines and points with, for instance, PGLINE or PGPOINT
one has to convert the true world coordinates (longitude and latitude in
degrees) to map coordinates that are linearly mapped into viewport. One is
adviced to use PMCONV for this purpose. Only in case of the Equi-Rectangular
Projection, which is linear in both direction, the use of PMCONV is optional
since then true world and map coordinates are identical.
Referring to the Subroutine Synopsis below for more detailed description of the
routine inputs and outputs, the setup of a map could be lined out as follows:
\begin{itemize}
\item Open device with PGBEG or PGOPEN, as usual.
\item Open a viewport with PGVSTD, PGVSIZ or PGSVP (if necessary, preceded
    by PGPAGE to advance the page).
\item Define the projection type and scale with PMDEF. Additionally, include
    the projection parameters.
\item Define the map boundaries with PMSWIN. The viewport size and shape will
    automatically be adjusted conform the scale and projection type define in
    PMDEF. If no scale is defined, the map will be the largest that can fit
    within the original viewport. For some projections the mapped area will
    be larger than the one defined, because of the fact that the area will not
    be mapped rectangularly. However, the map is the smallest that can fit
    around the defined area.
\item Call PMWDB to draw coastlines, lakes, rivers, and/or borders.
\item PGCONV converts the latitude and longitude of two points to map
    coordinates. Afterwards the standard PGPLOT routines PGPOINT and
    PGPTXT can be used to plot markers and text.
\item RNGCIR and GRTCIR can be used to compute range and great circles.
    A sequence of PMCONV and PGLINE can be called afterwards to draw the
    circles.
\item Use PMBOX to draw meridians, parallels, ticks, annotations, etc.
\item Finally, PMBAR plots a scale bar above the map.
\end{itemize}

As long as no other call to PMDEF is made, the projection type and scale remain
unchanged. If the scale was not set in PMDEF (i.e. the parameter \verb|SCALE| was set
to \verb|0.0|) the actual scale of your map will be computed by PMSWIN, along with
the reshaping of the viewport, such that it exactly encompasses the area to be
mapped. Once set or computed, the scale will not be altered, even if you call
PMSWIN again.

As far as the map boundaries are concerned, they must be, as said before,
defined
in a call to PMSWIN. If the projection type is Cylindrical, the boundaries
entered by the user directly define the edges of the window. On the other hand,
if a projection is chosen that is not Cylindrical, such as the Conic ones where
the meridians are tilted and the parallels are curved, the area boundaries as
mapped in your chart do not coincide with the edges of the window. Therefore
PMSWIN, by itself, slightly adjusts the area boundaries, such that (1) the
window edges touch all corners of the mapped original area and is thus the
smallest that can fit around the area, and (2) the entire window is covered by
the new area. In other words, the area defined by the new boundaries is the
smallest that can fit around the rectangular window.

In case of Azimuthal projections, which are essentially meant to be used to
portrait the whole world, or at least a hemisphere, the boundaries are
automatically set to --180 through +180 degrees longitude and --90 through +90
degrees latitude.

\section{Subroutine description}
\subsection{PMPLOT routines}
Apart from the abovementioned PMPLOT routines PMDEF, PMSWIN, and
PMWDB, there are a couple of routines in conjunction with them to make
maps. These routines can only be used {\em after} calling PMDEF.

\begin{description}
\item[PMDEF]
This routine has to be called before any other PMPLOT routine. The
routine has four parameters: the projection type, as described in
Section~\ref{projections}; scale; and two projection parameters.
By giving a scale of '0.0', the plot will be scaled automatically.
The projection parameters usually refer to the `true scale parallels'
(latitudes at which the plot is at true scale both in longitudinal and
latitudinal direction).

\item[PMQDEF]
This routine queries the scale and projection type.

\item[PMQINF]
Queries more information on the PMPLOT version and projection parameters.

\item[PMSWIN]
Defines the map boundaries. The viewport size and shape will
automatically be adjusted conform the scale and projection type define in
PMDEF. If no scale is defined, the map will be the largest that can fit
within the original viewport. For some projections the mapped area will
be larger than the one defined, because of the fact that the area will not
be mapped rectangularly. However, the map is the smallest that can fit
around the defined area.

\item[PMWDB]
is a routine that is especially designed to plot maps of coastlines,
islands, lakes, rivers, state and national boundaries, bathymetry, and
mountains as lines, or filled-in land masses.
The usage is extensively described in Section~\ref{WDB}.

\item[PMCONV and PMCINV]
These routines convert true world (longitude,latitude) coordinates to map
(x,y) coordinates (PMCONV) or vice versa (PMCINV). These routines convert the
coordinates of an indefinite number of points in one call.

\item[PMCVEC and PGPTX]
In order to be able to draw vectors of different size and azimuth in a
geographical projection PMCVEC and PGPTX can be used.
First PMCVEC converts the real-world coordinates (longitude,latitude) and
the given azimuth of the direction of the vector to map coordinates (x,y)
and a tilt. This tilt is measured from the +x axis. The second step is to
call PGPTX (which is and is in fact NOT a PMPLOT routine, but an extension to
the regular PGPLOT routines), with a proper symbol. Symbol numbers 0858 (an
arrow with a small head pointing to the right) and 0859 (a wind vane) are
especially useful for this purpose. If you want to draw a legend, use e.g.
PGMTXT to plot the string {\tt'\bs(0858) = 30 m/s'}.

\item[PMX]
is a function that returns the plot coordinate X for given longitude and
plot coordinate Y.

\item[PMY]
is a function that returns the plot coordinate Y for given latitude and
plot coordinate X.

\item[PMBOX]
This routine is very similar to PGBOX, however, PMBOX is also able to draw
tilted or curved meridians or parallels and not-equally spaced ticks and
annotations. This routine, rather than PGBOX, should be used, after PMSWIN,
to draw these items. PMBOX has all kinds of special options to give a
nice annotation and plot curved grid lines.

\item[PMBAR]
With this routine a scale bar can be drawn at the top or the bottom of the
window, either aligned with the left or the right of the viewport or centered.

\item[PMRND]
Finds a suitable 'round' number just above a value given by the user.
\end{description}

\subsection{Stand-alone routines}
To facilitate plotting of some generally used items as range circles and
great circles, two routines have been generated to compute the coordinates
of points along these lines. However, neither of the routines produce
graphics. For instance, one can combine calls to RNGCIR, PMCONV and PGLINE
to draw a range circle.

\begin{description}
\item[RNGCIR]
Computes the coordinates of points at a specified range and azimuth range from
a point. This routine does not draw anything, nor does it call PGPLOT routines
or is it used explicitly with PMPLOT; it simply computes, nothing else.

\item[GRTCIR]
Computes the points along a great circle between to locations on the earth.
Especially useful to draw the shortest route between these points. As RNGCIR,
this is a stand-alone subroutine.

\item[SATOBS]
Computes the coordinates of the sub-satellite point from range,
elevation, and azimuth from an earthly observer.

\item[LENCHR]
Function that returns the number of characters in a string, excluding
trailing spaces.
\end{description}

\subsection{Additional or redefined PGPLOT routines}
Some routines have been incorporate in the PMPLOT library that are actually
an extension to PGPLOT. Consequently, they can be used without any call to
PMDEF, or any other PMPLOT routine. Most of them are made to improve
the PGPLOT plotting facilities.

\begin{description}
\item[PGSVPX]
can be used to set the viewport in any preferred units (absolute device
coordinates, normalised device coordinates, inches, or centimeters), unlike
PGSVP, that only allows normalised device coordinates.

\item[PGCLIP]
allows you to regulate the clipping of lines or symbols. Usually,
lines are always clipped at the area boundaries and symbols are only
drawn when the center is within the viewport, and are not clipped at the
boundaries. With PGCLIP you can specify several stages of clipping of
lines and symbols.

\item[PGPIXL]
This routine was created by Ge van Geldorp to make pixel dumps of arrays.
In the specially adjusted version, PGPIXL is able to make pixel dumps
to any device, including PostScript. For screen devices, colors are
generated according to the color map that is set with PGSCR. The same
works now also for a color PostScript device /CPS and /CVPS. A grey
map is generated on regular PostScript devices.

\item[PGPTX]
As described above, PGPTX draws marks with various magnifications and
at various tilts.

\item[PGNORM]
Normalises a vector.

%\item[GRXHEX]
%Converts (Red, Green, Blue) values to the appropriate index code, to
%be used with the `true color' PPM device.
\end{description}

\subsection{Additional markers}
In order to facilitate vector plotting two markers were added to the PGPLOT
font library (See Figure~\ref{fig:symbol}):
\begin{description}
\item[0858]
An arrow with a small head pointing to the right, and centered
in the middle of the horizontal line.
\item[0859]
A wind vane pointing to the
right and centered at left edge of the horizontal line.
\end{description}

Another five additional
fonts were generated with the intention to be used for notations. The five
markers (0791 through 0795) represent line styles 1 through 5 as defined in
PGSLS. Use for instance {\tt'\bs(0793) velocity'}
as text in your call to PGTEXT,
PGPTXT or PGMTXT to indicate that the dash-dot-dash-dot line represents
velocity.
\begin{description}
\item[0791-0795] Line-styles 1 (full line), 2 (dashed line),
  3 (dash-dot line), 4 (dotted line), and 5 (dash-dot-dot-dot-dash line).
\end{description}

Satellite Laser Ranging systems can be plotted with the markers 0879
through 0891. Since markers 0881--0890 have no width, you can also
combine an SLR system as a string
\verb|'\bs(0879)\bs(0881)\bs(0886)\bs(0891)'|.
\begin{description}
\item[0879] Fixed SLR bed.
\item[0880] Mobile SLR system.
\item[0881--0885] SLR objective in five angles.
\item[0886--0890] Camera in five angles, to be `mounted' on characters
0881--0885.
\item[0891] Reference point or center-of-mass. It completes a sequence
of characters 0879--0880, 0881--0890, and 0891, when used as a string.
\end{description}

Also two markers are designed to draw an ocean platform. When fitted
on top of eachother, characters 0892 and 0893 form a tower at sea.
\begin{description}
\item[0892] Ocean platform, including submarine structure.
\item[0893] Water level.
\end{description}

\begin{figure*}[h]
\includegraphics[angle=90,width=\textwidth]{symbol.pdf}
\caption{Some Hershy fonts defined in PMPLOT.}
\label{fig:symbol}
\end{figure*}

\clearpage
\section{Subroutine synopsis}
\Input{grtcir}
\Input{pgclip}
\Input{pgnorm}
\Input{pgnumb}
\Input{pgpt}
\Input{pgptx}
\Input{pgsvpx}
\Input{pmbar}
\clearpage
\input{pmbox}
\Input{pmcinv}
\Input{pmconv}
\Input{pmcvec}
\Input{pmcpol}
\input{pmdef}
\Input{pmqdef}
\Input{pmqinf}
\Input{pmrnd}
\Input{pmwdb}
\Input{pmswin}
\Input{pmx}
\Input{pmy}
\Input{rngcir}
\Input{satobs}
\end{document}
